I have included the Visual Studio solution for more convenient testing. 
The programs work when compiled with the microsoft compiler.
I have not tested them in Linux environment.